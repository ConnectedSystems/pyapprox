

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pyapprox.benchmarks.sensitivity_benchmarks &mdash; PyApprox 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/gallery-dataframe.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"V": ["{\\boldsymbol{#1}}", 1], "mean": ["{\\mathbb{E}\\left[#1\\right]}", 1], "var": ["{\\mathbb{V}\\left[#1\\right]}", 1], "argmin": "{\\mathrm{argmin}}", "rv": "z", "reals": "\\mathbb{R}", "pdf": "\\rho", "rvdom": "\\Gamma", "coloneqq": "\\colon=", "norm": ["{\\lVert #1 \\rVert}", 1], "argmax": ["\\operatorname{argmax}"], "covar": ["\\mathbb{C}\\text{ov}\\left[#1,#2\\right]", 2], "corr": ["\\mathbb{C}\\text{or}\\left[#1,#2\\right]", 2], "ai": "\\alpha", "bi": "\\beta", "dx": ["\\;\\mathrm{d}#1", 1]}}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> PyApprox
          

          
            
            <img src="../../../_static/pyapprox-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../intro.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../auto_tutorials/index.html">PyApprox Tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">Benchmarks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../benchmarks.html">Benchmarks</a></li>
</ul>
<p class="caption"><span class="caption-text">User Reference Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../user_reference_guide.html">User Reference Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Reference Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">Developer Reference Guide</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">PyApprox</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>pyapprox.benchmarks.sensitivity_benchmarks</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pyapprox.benchmarks.sensitivity_benchmarks</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">pyapprox.utilities</span> <span class="kn">import</span> <span class="n">evaluate_quadratic_form</span>
<div class="viewcode-block" id="variance_linear_combination_of_indendent_variables"><a class="viewcode-back" href="../../../api/pyapprox.benchmarks.sensitivity_benchmarks.variance_linear_combination_of_indendent_variables.html#pyapprox.benchmarks.sensitivity_benchmarks.variance_linear_combination_of_indendent_variables">[docs]</a><span class="k">def</span> <span class="nf">variance_linear_combination_of_indendent_variables</span><span class="p">(</span><span class="n">coef</span><span class="p">,</span><span class="n">variances</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">coef</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">variances</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">coef</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">variances</span><span class="p">)</span></div>

<div class="viewcode-block" id="get_oakley_function_data"><a class="viewcode-back" href="../../../api/pyapprox.benchmarks.sensitivity_benchmarks.get_oakley_function_data.html#pyapprox.benchmarks.sensitivity_benchmarks.get_oakley_function_data">[docs]</a><span class="k">def</span> <span class="nf">get_oakley_function_data</span><span class="p">():</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the data :math:`a_1,a_2,a_3` and :math:`M` of the Oakley function</span>

<span class="sd">    .. math:: f(z) = a_1^Tz + a_2^T\sin(z) + a_3^T\cos(z) + z^TMz</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    a1 : np.ndarray (15)</span>
<span class="sd">       The vector :math:`a_1` of the Oakley function</span>

<span class="sd">    a2 : np.ndarray (15)</span>
<span class="sd">       The vector :math:`a_2` of the Oakley function</span>

<span class="sd">    a3 : np.ndarray (15)</span>
<span class="sd">       The vector :math:`a_3` of the Oakley function</span>

<span class="sd">    M : np.ndarray (15,15)</span>
<span class="sd">       The non-symmetric matrix :math:`M` of the Oakley function</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; from pyapprox.benchmarks.sensitivity_benchmarks import get_oakley_function_data</span>
<span class="sd">    &gt;&gt;&gt; a1,a2,a3,M=get_oakley_function_data()</span>
<span class="sd">    &gt;&gt;&gt; print(a1)</span>
<span class="sd">    [0.0118 0.0456 0.2297 0.0393 0.1177 0.3865 0.3897 0.6061 0.6159 0.4005</span>
<span class="sd">     1.0741 1.1474 0.788  1.1242 1.1982]</span>
<span class="sd">    &gt;&gt;&gt; print(a2)</span>
<span class="sd">    [0.4341 0.0887 0.0512 0.3233 0.1489 1.036  0.9892 0.9672 0.8977 0.8083</span>
<span class="sd">     1.8426 2.4712 2.3946 2.0045 2.2621]</span>
<span class="sd">    &gt;&gt;&gt; print(a3)</span>
<span class="sd">    [0.1044 0.2057 0.0774 0.273  0.1253 0.7526 0.857  1.0331 0.8388 0.797</span>
<span class="sd">     2.2145 2.0382 2.4004 2.0541 1.9845]</span>
<span class="sd">    &gt;&gt;&gt; print(M)</span>
<span class="sd">    [[-0.02248289 -0.18501666  0.13418263  0.36867264  0.17172785  0.13651143</span>
<span class="sd">      -0.44034404 -0.08142285  0.71321025 -0.44361072  0.50383394 -0.02410146</span>
<span class="sd">      -0.04593968  0.21666181  0.05588742]</span>
<span class="sd">     [ 0.2565963   0.05379229  0.25800381  0.23795905 -0.59125756 -0.08162708</span>
<span class="sd">      -0.28749073  0.41581639  0.49752241  0.08389317 -0.11056683  0.03322235</span>
<span class="sd">      -0.13979497 -0.03102056 -0.22318721]</span>
<span class="sd">     [-0.05599981  0.19542252  0.09552901 -0.2862653  -0.14441303  0.22369356</span>
<span class="sd">       0.14527412  0.28998481  0.2310501  -0.31929879 -0.29039128 -0.20956898</span>
<span class="sd">       0.43139047  0.02442915  0.04490441]</span>
<span class="sd">     [ 0.66448103  0.43069872  0.29924645 -0.16202441 -0.31479544 -0.39026802</span>
<span class="sd">       0.17679822  0.05795266  0.17230342  0.13466011 -0.3527524   0.25146896</span>
<span class="sd">      -0.01881053  0.36482392 -0.32504618]</span>
<span class="sd">     [-0.121278    0.12463327  0.10656519  0.0465623  -0.21678617  0.19492172</span>
<span class="sd">      -0.06552113  0.02440467 -0.09682886  0.19366196  0.33354757  0.31295994</span>
<span class="sd">      -0.08361546 -0.25342082  0.37325717]</span>
<span class="sd">     [-0.2837623  -0.32820154 -0.10496068 -0.22073452 -0.13708154 -0.14426375</span>
<span class="sd">      -0.11503319  0.22424151 -0.03039502 -0.51505615  0.01725498  0.03895712</span>
<span class="sd">       0.36069184  0.30902452  0.05003019]</span>
<span class="sd">     [-0.07787589  0.00374566  0.88685604 -0.26590028 -0.07932536 -0.04273492</span>
<span class="sd">      -0.18653782 -0.35604718 -0.17497421  0.08869996  0.40025886 -0.05597969</span>
<span class="sd">       0.13724479  0.21485613 -0.0112658 ]</span>
<span class="sd">     [-0.09229473  0.59209563  0.03133829 -0.03308086 -0.24308858 -0.09979855</span>
<span class="sd">       0.03446019  0.09511981 -0.3380162   0.006386   -0.61207299  0.08132542</span>
<span class="sd">       0.88683114  0.14254905  0.14776204]</span>
<span class="sd">     [-0.13189434  0.52878496  0.12652391  0.04511362  0.58373514  0.37291503</span>
<span class="sd">       0.11395325 -0.29479222 -0.57014085  0.46291592 -0.09405018  0.13959097</span>
<span class="sd">      -0.38607402 -0.4489706  -0.14602419]</span>
<span class="sd">     [ 0.05810766 -0.32289338  0.09313916  0.07242723 -0.56919401  0.52554237</span>
<span class="sd">       0.23656926 -0.01178202  0.0718206   0.07827729 -0.13355752  0.22722721</span>
<span class="sd">       0.14369455 -0.45198935 -0.55574794]</span>
<span class="sd">     [ 0.66145875  0.34633299  0.14098019  0.51882591 -0.28019898 -0.1603226</span>
<span class="sd">      -0.06841334 -0.20428242  0.06967217  0.23112577 -0.04436858 -0.16455425</span>
<span class="sd">       0.21620977  0.00427021 -0.08739901]</span>
<span class="sd">     [ 0.31599556 -0.02755186  0.13434254  0.13497371  0.05400568 -0.17374789</span>
<span class="sd">       0.17525393  0.06025893 -0.17914162 -0.31056619 -0.25358691  0.02584754</span>
<span class="sd">      -0.43006001 -0.62266361 -0.03399688]</span>
<span class="sd">     [-0.29038151  0.03410127  0.03490341 -0.12121764  0.02603071 -0.33546274</span>
<span class="sd">      -0.41424111  0.05324838 -0.27099455 -0.0262513   0.41024137  0.26636349</span>
<span class="sd">       0.15582891 -0.18666254  0.01989583]</span>
<span class="sd">     [-0.24388652 -0.44098852  0.01261883  0.24945112  0.07110189  0.24623792</span>
<span class="sd">       0.17484502  0.00852868  0.2514707  -0.14659862 -0.08462515  0.36931333</span>
<span class="sd">      -0.29955293  0.1104436  -0.75690139]</span>
<span class="sd">     [ 0.04149432 -0.25980564  0.46402128 -0.36112127 -0.94980789 -0.16504063</span>
<span class="sd">       0.00309433  0.05279294  0.22523648  0.38390366  0.45562427 -0.18631744</span>
<span class="sd">       0.0082334   0.16670803  0.16045688]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0118</span><span class="p">,</span><span class="mf">0.0456</span><span class="p">,</span><span class="mf">0.2297</span><span class="p">,</span><span class="mf">0.0393</span><span class="p">,</span><span class="mf">0.1177</span><span class="p">,</span><span class="mf">0.3865</span><span class="p">,</span><span class="mf">0.3897</span><span class="p">,</span><span class="mf">0.6061</span><span class="p">,</span><span class="mf">0.6159</span><span class="p">,</span><span class="mf">0.4005</span><span class="p">,</span>
                   <span class="mf">1.0741</span><span class="p">,</span><span class="mf">1.1474</span><span class="p">,</span><span class="mf">0.7880</span><span class="p">,</span><span class="mf">1.1242</span><span class="p">,</span><span class="mf">1.1982</span><span class="p">])</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4341</span><span class="p">,</span><span class="mf">0.0887</span><span class="p">,</span><span class="mf">0.0512</span><span class="p">,</span><span class="mf">0.3233</span><span class="p">,</span><span class="mf">0.1489</span><span class="p">,</span><span class="mf">1.0360</span><span class="p">,</span><span class="mf">0.9892</span><span class="p">,</span><span class="mf">0.9672</span><span class="p">,</span><span class="mf">0.8977</span><span class="p">,</span><span class="mf">0.8083</span><span class="p">,</span>
                   <span class="mf">1.8426</span><span class="p">,</span><span class="mf">2.4712</span><span class="p">,</span><span class="mf">2.3946</span><span class="p">,</span><span class="mf">2.0045</span><span class="p">,</span><span class="mf">2.2621</span><span class="p">])</span>
    <span class="n">a3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1044</span><span class="p">,</span><span class="mf">0.2057</span><span class="p">,</span><span class="mf">0.0774</span><span class="p">,</span><span class="mf">0.2730</span><span class="p">,</span><span class="mf">0.1253</span><span class="p">,</span><span class="mf">0.7526</span><span class="p">,</span><span class="mf">0.8570</span><span class="p">,</span><span class="mf">1.0331</span><span class="p">,</span><span class="mf">0.8388</span><span class="p">,</span><span class="mf">0.7970</span><span class="p">,</span>
                   <span class="mf">2.2145</span><span class="p">,</span><span class="mf">2.0382</span><span class="p">,</span><span class="mf">2.4004</span><span class="p">,</span><span class="mf">2.0541</span><span class="p">,</span><span class="mf">1.9845</span><span class="p">])</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">2.2482886e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">1.8501666e-001</span><span class="p">,</span><span class="mf">1.3418263e-001</span><span class="p">,</span><span class="mf">3.6867264e-001</span><span class="p">,</span><span class="mf">1.7172785e-001</span><span class="p">,</span><span class="mf">1.3651143e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">4.4034404e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">8.1422854e-002</span><span class="p">,</span><span class="mf">7.1321025e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">4.4361072e-001</span><span class="p">,</span><span class="mf">5.0383394e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">2.4101458e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">4.5939684e-002</span><span class="p">,</span><span class="mf">2.1666181e-001</span><span class="p">,</span><span class="mf">5.5887417e-002</span><span class="p">],</span>
         <span class="p">[</span><span class="mf">2.5659630e-001</span><span class="p">,</span><span class="mf">5.3792287e-002</span><span class="p">,</span><span class="mf">2.5800381e-001</span><span class="p">,</span><span class="mf">2.3795905e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">5.9125756e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">8.1627077e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">2.8749073e-001</span><span class="p">,</span><span class="mf">4.1581639e-001</span><span class="p">,</span><span class="mf">4.9752241e-001</span><span class="p">,</span><span class="mf">8.3893165e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">1.1056683e-001</span><span class="p">,</span><span class="mf">3.3222351e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">1.3979497e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">3.1020556e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">2.2318721e-001</span><span class="p">],</span>
         <span class="p">[</span><span class="o">-</span><span class="mf">5.5999811e-002</span><span class="p">,</span><span class="mf">1.9542252e-001</span><span class="p">,</span><span class="mf">9.5529005e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">2.8626530e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">1.4441303e-001</span><span class="p">,</span><span class="mf">2.2369356e-001</span><span class="p">,</span><span class="mf">1.4527412e-001</span><span class="p">,</span><span class="mf">2.8998481e-001</span><span class="p">,</span><span class="mf">2.3105010e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">3.1929879e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">2.9039128e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">2.0956898e-001</span><span class="p">,</span><span class="mf">4.3139047e-001</span><span class="p">,</span><span class="mf">2.4429152e-002</span><span class="p">,</span><span class="mf">4.4904409e-002</span><span class="p">],</span>
         <span class="p">[</span><span class="mf">6.6448103e-001</span><span class="p">,</span><span class="mf">4.3069872e-001</span><span class="p">,</span><span class="mf">2.9924645e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">1.6202441e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">3.1479544e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">3.9026802e-001</span><span class="p">,</span><span class="mf">1.7679822e-001</span><span class="p">,</span><span class="mf">5.7952663e-002</span><span class="p">,</span><span class="mf">1.7230342e-001</span><span class="p">,</span><span class="mf">1.3466011e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">3.5275240e-001</span><span class="p">,</span><span class="mf">2.5146896e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">1.8810529e-002</span><span class="p">,</span><span class="mf">3.6482392e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">3.2504618e-001</span><span class="p">],</span>
         <span class="p">[</span><span class="o">-</span><span class="mf">1.2127800e-001</span><span class="p">,</span><span class="mf">1.2463327e-001</span><span class="p">,</span><span class="mf">1.0656519e-001</span><span class="p">,</span><span class="mf">4.6562296e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">2.1678617e-001</span><span class="p">,</span><span class="mf">1.9492172e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">6.5521126e-002</span><span class="p">,</span><span class="mf">2.4404669e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">9.6828860e-002</span><span class="p">,</span><span class="mf">1.9366196e-001</span><span class="p">,</span><span class="mf">3.3354757e-001</span><span class="p">,</span><span class="mf">3.1295994e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">8.3615456e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">2.5342082e-001</span><span class="p">,</span><span class="mf">3.7325717e-001</span><span class="p">],</span>
         <span class="p">[</span><span class="o">-</span><span class="mf">2.8376230e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">3.2820154e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">1.0496068e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">2.2073452e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">1.3708154e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">1.4426375e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">1.1503319e-001</span><span class="p">,</span><span class="mf">2.2424151e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">3.0395022e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">5.1505615e-001</span><span class="p">,</span><span class="mf">1.7254978e-002</span><span class="p">,</span><span class="mf">3.8957118e-002</span><span class="p">,</span><span class="mf">3.6069184e-001</span><span class="p">,</span><span class="mf">3.0902452e-001</span><span class="p">,</span><span class="mf">5.0030193e-002</span><span class="p">],</span>
         <span class="p">[</span><span class="o">-</span><span class="mf">7.7875893e-002</span><span class="p">,</span><span class="mf">3.7456560e-003</span><span class="p">,</span><span class="mf">8.8685604e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">2.6590028e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">7.9325357e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">4.2734919e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">1.8653782e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">3.5604718e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">1.7497421e-001</span><span class="p">,</span><span class="mf">8.8699956e-002</span><span class="p">,</span><span class="mf">4.0025886e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">5.5979693e-002</span><span class="p">,</span><span class="mf">1.3724479e-001</span><span class="p">,</span><span class="mf">2.1485613e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">1.1265799e-002</span><span class="p">],</span>
         <span class="p">[</span><span class="o">-</span><span class="mf">9.2294730e-002</span><span class="p">,</span><span class="mf">5.9209563e-001</span><span class="p">,</span><span class="mf">3.1338285e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">3.3080861e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">2.4308858e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">9.9798547e-002</span><span class="p">,</span><span class="mf">3.4460195e-002</span><span class="p">,</span><span class="mf">9.5119813e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">3.3801620e-001</span><span class="p">,</span><span class="mf">6.3860024e-003</span><span class="p">,</span><span class="o">-</span><span class="mf">6.1207299e-001</span><span class="p">,</span><span class="mf">8.1325416e-002</span><span class="p">,</span><span class="mf">8.8683114e-001</span><span class="p">,</span><span class="mf">1.4254905e-001</span><span class="p">,</span><span class="mf">1.4776204e-001</span><span class="p">],</span>
         <span class="p">[</span><span class="o">-</span><span class="mf">1.3189434e-001</span><span class="p">,</span><span class="mf">5.2878496e-001</span><span class="p">,</span><span class="mf">1.2652391e-001</span><span class="p">,</span><span class="mf">4.5113625e-002</span><span class="p">,</span><span class="mf">5.8373514e-001</span><span class="p">,</span><span class="mf">3.7291503e-001</span><span class="p">,</span><span class="mf">1.1395325e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">2.9479222e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">5.7014085e-001</span><span class="p">,</span><span class="mf">4.6291592e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">9.4050179e-002</span><span class="p">,</span><span class="mf">1.3959097e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">3.8607402e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">4.4897060e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">1.4602419e-001</span><span class="p">],</span>
         <span class="p">[</span><span class="mf">5.8107658e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">3.2289338e-001</span><span class="p">,</span><span class="mf">9.3139162e-002</span><span class="p">,</span><span class="mf">7.2427234e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">5.6919401e-001</span><span class="p">,</span><span class="mf">5.2554237e-001</span><span class="p">,</span><span class="mf">2.3656926e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">1.1782016e-002</span><span class="p">,</span><span class="mf">7.1820601e-002</span><span class="p">,</span><span class="mf">7.8277291e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">1.3355752e-001</span><span class="p">,</span><span class="mf">2.2722721e-001</span><span class="p">,</span><span class="mf">1.4369455e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">4.5198935e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">5.5574794e-001</span><span class="p">],</span>
         <span class="p">[</span><span class="mf">6.6145875e-001</span><span class="p">,</span><span class="mf">3.4633299e-001</span><span class="p">,</span><span class="mf">1.4098019e-001</span><span class="p">,</span><span class="mf">5.1882591e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">2.8019898e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">1.6032260e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">6.8413337e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">2.0428242e-001</span><span class="p">,</span><span class="mf">6.9672173e-002</span><span class="p">,</span><span class="mf">2.3112577e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">4.4368579e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">1.6455425e-001</span><span class="p">,</span><span class="mf">2.1620977e-001</span><span class="p">,</span><span class="mf">4.2702105e-003</span><span class="p">,</span><span class="o">-</span><span class="mf">8.7399014e-002</span><span class="p">],</span>
         <span class="p">[</span><span class="mf">3.1599556e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">2.7551859e-002</span><span class="p">,</span><span class="mf">1.3434254e-001</span><span class="p">,</span><span class="mf">1.3497371e-001</span><span class="p">,</span><span class="mf">5.4005680e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">1.7374789e-001</span><span class="p">,</span><span class="mf">1.7525393e-001</span><span class="p">,</span><span class="mf">6.0258929e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">1.7914162e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">3.1056619e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">2.5358691e-001</span><span class="p">,</span><span class="mf">2.5847535e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">4.3006001e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">6.2266361e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">3.3996882e-002</span><span class="p">],</span>
         <span class="p">[</span><span class="o">-</span><span class="mf">2.9038151e-001</span><span class="p">,</span><span class="mf">3.4101270e-002</span><span class="p">,</span><span class="mf">3.4903413e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">1.2121764e-001</span><span class="p">,</span><span class="mf">2.6030714e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">3.3546274e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">4.1424111e-001</span><span class="p">,</span><span class="mf">5.3248380e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">2.7099455e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">2.6251302e-002</span><span class="p">,</span><span class="mf">4.1024137e-001</span><span class="p">,</span><span class="mf">2.6636349e-001</span><span class="p">,</span><span class="mf">1.5582891e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">1.8666254e-001</span><span class="p">,</span><span class="mf">1.9895831e-002</span><span class="p">],</span>
         <span class="p">[</span><span class="o">-</span><span class="mf">2.4388652e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">4.4098852e-001</span><span class="p">,</span><span class="mf">1.2618825e-002</span><span class="p">,</span><span class="mf">2.4945112e-001</span><span class="p">,</span><span class="mf">7.1101888e-002</span><span class="p">,</span><span class="mf">2.4623792e-001</span><span class="p">,</span><span class="mf">1.7484502e-001</span><span class="p">,</span><span class="mf">8.5286769e-003</span><span class="p">,</span><span class="mf">2.5147070e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">1.4659862e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">8.4625150e-002</span><span class="p">,</span><span class="mf">3.6931333e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">2.9955293e-001</span><span class="p">,</span><span class="mf">1.1044360e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">7.5690139e-001</span><span class="p">],</span>
         <span class="p">[</span><span class="mf">4.1494323e-002</span><span class="p">,</span><span class="o">-</span><span class="mf">2.5980564e-001</span><span class="p">,</span><span class="mf">4.6402128e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">3.6112127e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">9.4980789e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">1.6504063e-001</span><span class="p">,</span><span class="mf">3.0943325e-003</span><span class="p">,</span><span class="mf">5.2792942e-002</span><span class="p">,</span><span class="mf">2.2523648e-001</span><span class="p">,</span><span class="mf">3.8390366e-001</span><span class="p">,</span><span class="mf">4.5562427e-001</span><span class="p">,</span><span class="o">-</span><span class="mf">1.8631744e-001</span><span class="p">,</span><span class="mf">8.2333995e-003</span><span class="p">,</span><span class="mf">1.6670803e-001</span><span class="p">,</span><span class="mf">1.6045688e-001</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">a3</span><span class="p">,</span><span class="n">M</span></div>

<div class="viewcode-block" id="oakley_function"><a class="viewcode-back" href="../../../api/pyapprox.benchmarks.sensitivity_benchmarks.oakley_function.html#pyapprox.benchmarks.sensitivity_benchmarks.oakley_function">[docs]</a><span class="k">def</span> <span class="nf">oakley_function</span><span class="p">(</span><span class="n">samples</span><span class="p">):</span>
    <span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">a3</span><span class="p">,</span><span class="n">M</span> <span class="o">=</span> <span class="n">get_oakley_function_data</span><span class="p">()</span>
    <span class="n">term1</span><span class="p">,</span><span class="n">term2</span> <span class="o">=</span> <span class="n">a1</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">samples</span><span class="p">),</span><span class="n">a2</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">samples</span><span class="p">))</span>
    <span class="n">term3</span><span class="p">,</span><span class="n">term4</span> <span class="o">=</span> <span class="n">a3</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">samples</span><span class="p">)),</span><span class="n">evaluate_quadratic_form</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">samples</span><span class="p">)</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="n">term1</span><span class="o">+</span><span class="n">term2</span><span class="o">+</span><span class="n">term3</span><span class="o">+</span><span class="n">term4</span>
    <span class="k">return</span> <span class="n">vals</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span></div>

<div class="viewcode-block" id="oakley_function_statistics"><a class="viewcode-back" href="../../../api/pyapprox.benchmarks.sensitivity_benchmarks.oakley_function_statistics.html#pyapprox.benchmarks.sensitivity_benchmarks.oakley_function_statistics">[docs]</a><span class="k">def</span> <span class="nf">oakley_function_statistics</span><span class="p">():</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">a3</span><span class="p">,</span><span class="n">M</span> <span class="o">=</span> <span class="n">get_oakley_function_data</span><span class="p">()</span>
    <span class="n">nvars</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">term1_mean</span><span class="p">,</span> <span class="n">term2_mean</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
    <span class="n">term3_mean</span><span class="p">,</span> <span class="n">term4_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a3</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">e</span><span class="p">)),</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">term1_mean</span><span class="o">+</span><span class="n">term2_mean</span><span class="o">+</span><span class="n">term3_mean</span><span class="o">+</span><span class="n">term4_mean</span>
    
    <span class="n">term1_var</span><span class="o">=</span><span class="n">variance_linear_combination_of_indendent_variables</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">variances_1d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">a2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">e</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">term2_var</span><span class="o">=</span><span class="n">variance_linear_combination_of_indendent_variables</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span><span class="n">variances_1d</span><span class="p">)</span>
    <span class="n">variances_1d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">a3</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="n">e</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">e</span><span class="p">)</span>
    <span class="n">term3_var</span><span class="o">=</span> <span class="n">variance_linear_combination_of_indendent_variables</span><span class="p">(</span><span class="n">a3</span><span class="p">,</span><span class="n">variances_1d</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">T</span><span class="o">+</span><span class="n">M</span><span class="p">)</span><span class="c1"># needed because M is not symmetric</span>
    <span class="n">term4_var</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>

    <span class="n">cov_xsinx</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="n">covar13</span><span class="p">,</span><span class="n">covar14</span><span class="p">,</span><span class="n">covar23</span><span class="p">,</span><span class="n">covar24</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
    <span class="n">covar12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">a2</span><span class="o">*</span><span class="n">cov_xsinx</span><span class="p">)</span>
    <span class="n">covar34</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="n">a3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>

    <span class="n">variance</span> <span class="o">=</span> <span class="n">term1_var</span><span class="o">+</span><span class="n">term2_var</span><span class="o">+</span><span class="n">term3_var</span><span class="o">+</span><span class="n">term4_var</span>
    <span class="n">variance</span> <span class="o">+=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">covar12</span><span class="o">+</span><span class="n">covar13</span><span class="o">+</span><span class="n">covar14</span><span class="o">+</span><span class="n">covar23</span><span class="o">+</span><span class="n">covar24</span><span class="o">+</span><span class="n">covar34</span><span class="p">)</span>
    <span class="n">main_effects</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">nvars</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nvars</span><span class="p">):</span>
        <span class="n">var1</span><span class="o">=</span><span class="n">a1</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">var2</span><span class="o">=</span><span class="n">a2</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">e</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">var3</span><span class="o">=</span><span class="n">a3</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="n">e</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="n">e</span><span class="p">)</span>
        <span class="n">var4</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span><span class="n">ii</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">cov12</span><span class="o">=</span><span class="n">cov_xsinx</span><span class="o">*</span><span class="n">a1</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="n">a2</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
        <span class="n">cov34</span><span class="o">=-</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="n">a3</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="n">M</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span><span class="n">ii</span><span class="p">]</span>
        <span class="n">main_effects</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">var1</span><span class="o">+</span><span class="n">var2</span><span class="o">+</span><span class="n">var3</span><span class="o">+</span><span class="n">var4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">cov12</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">cov34</span>
    
    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">variance</span><span class="p">,</span> <span class="n">main_effects</span><span class="o">/</span><span class="n">variance</span></div>

<div class="viewcode-block" id="ishigami_function"><a class="viewcode-back" href="../../../api/pyapprox.benchmarks.sensitivity_benchmarks.ishigami_function.html#pyapprox.benchmarks.sensitivity_benchmarks.ishigami_function">[docs]</a><span class="k">def</span> <span class="nf">ishigami_function</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">samples</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="n">samples</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span>\
        <span class="n">b</span><span class="o">*</span><span class="n">samples</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
    <span class="k">return</span> <span class="n">vals</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span></div>

<div class="viewcode-block" id="ishigami_function_jacobian"><a class="viewcode-back" href="../../../api/pyapprox.benchmarks.sensitivity_benchmarks.ishigami_function_jacobian.html#pyapprox.benchmarks.sensitivity_benchmarks.ishigami_function_jacobian">[docs]</a><span class="k">def</span> <span class="nf">ishigami_function_jacobian</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">samples</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="n">samples</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span>
    <span class="n">nvars</span><span class="o">=</span><span class="mi">3</span>
    <span class="k">assert</span> <span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">nvars</span>
    <span class="n">jac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">nvars</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">jac</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">samples</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
    <span class="n">jac</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span>
    <span class="n">jac</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">samples</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
    <span class="k">return</span> <span class="n">jac</span></div>

<div class="viewcode-block" id="ishigami_function_hessian"><a class="viewcode-back" href="../../../api/pyapprox.benchmarks.sensitivity_benchmarks.ishigami_function_hessian.html#pyapprox.benchmarks.sensitivity_benchmarks.ishigami_function_hessian">[docs]</a><span class="k">def</span> <span class="nf">ishigami_function_hessian</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">samples</span><span class="o">.</span><span class="n">ndim</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="n">samples</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span>
    <span class="n">nvars</span><span class="o">=</span><span class="mi">3</span>
    <span class="k">assert</span> <span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">nvars</span>
    <span class="n">hess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">nvars</span><span class="p">,</span><span class="n">nvars</span><span class="p">))</span>
    <span class="n">hess</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">samples</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span><span class="o">**</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
    <span class="n">hess</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">hess</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">samples</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
    <span class="n">hess</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">hess</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
    <span class="n">hess</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">samples</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]);</span> <span class="n">hess</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">hess</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">hess</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">hess</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
    <span class="k">return</span> <span class="n">hess</span></div>

<div class="viewcode-block" id="get_ishigami_funciton_statistics"><a class="viewcode-back" href="../../../api/pyapprox.benchmarks.sensitivity_benchmarks.get_ishigami_funciton_statistics.html#pyapprox.benchmarks.sensitivity_benchmarks.get_ishigami_funciton_statistics">[docs]</a><span class="k">def</span> <span class="nf">get_ishigami_funciton_statistics</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    p_i(X_i) ~ U[-pi,pi]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">variance</span> <span class="o">=</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">8</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="o">+</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">8</span><span class="o">/</span><span class="mi">18</span><span class="o">+</span><span class="mf">0.5</span>
    <span class="n">D_1</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="o">+</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">8</span><span class="o">/</span><span class="mi">50</span><span class="o">+</span><span class="mf">0.5</span>
    <span class="n">D_2</span><span class="p">,</span><span class="n">D_3</span><span class="p">,</span><span class="n">D_12</span><span class="p">,</span><span class="n">D_13</span> <span class="o">=</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">8</span><span class="o">/</span><span class="mi">18</span><span class="o">-</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">8</span><span class="o">/</span><span class="mi">50</span>
    <span class="n">D_23</span><span class="p">,</span><span class="n">D_123</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
    <span class="n">main_effects</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">D_1</span><span class="p">,</span><span class="n">D_2</span><span class="p">,</span><span class="n">D_3</span><span class="p">])</span><span class="o">/</span><span class="n">variance</span>
    <span class="c1"># the following two ways of calulating the total effects are equivalent</span>
    <span class="n">total_effects1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span><span class="n">D_1</span><span class="o">+</span><span class="n">D_12</span><span class="o">+</span><span class="n">D_13</span><span class="o">+</span><span class="n">D_123</span><span class="p">,</span><span class="n">D_2</span><span class="o">+</span><span class="n">D_12</span><span class="o">+</span><span class="n">D_23</span><span class="o">+</span><span class="n">D_123</span><span class="p">,</span><span class="n">D_3</span><span class="o">+</span><span class="n">D_13</span><span class="o">+</span><span class="n">D_23</span><span class="o">+</span><span class="n">D_123</span><span class="p">])</span><span class="o">/</span><span class="n">variance</span>
    <span class="n">total_effects</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">D_2</span><span class="o">+</span><span class="n">D_3</span><span class="o">+</span><span class="n">D_23</span><span class="p">,</span><span class="n">D_1</span><span class="o">+</span><span class="n">D_3</span><span class="o">+</span><span class="n">D_13</span><span class="p">,</span><span class="n">D_1</span><span class="o">+</span><span class="n">D_2</span><span class="o">+</span><span class="n">D_12</span><span class="p">])</span><span class="o">/</span><span class="n">variance</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">total_effects1</span><span class="p">,</span><span class="n">total_effects</span><span class="p">)</span>
    <span class="n">sobol_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">D_1</span><span class="p">,</span><span class="n">D_2</span><span class="p">,</span><span class="n">D_3</span><span class="p">,</span><span class="n">D_12</span><span class="p">,</span><span class="n">D_13</span><span class="p">,</span><span class="n">D_23</span><span class="p">,</span><span class="n">D_123</span><span class="p">])</span><span class="o">/</span><span class="n">variance</span>
    <span class="n">sobol_interaction_indices</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">variance</span><span class="p">,</span> <span class="n">main_effects</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">total_effects</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">sobol_indices</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">sobol_interaction_indices</span></div>

<div class="viewcode-block" id="sobol_g_function"><a class="viewcode-back" href="../../../api/pyapprox.benchmarks.sensitivity_benchmarks.sobol_g_function.html#pyapprox.benchmarks.sensitivity_benchmarks.sobol_g_function">[docs]</a><span class="k">def</span> <span class="nf">sobol_g_function</span><span class="p">(</span><span class="n">coefficients</span><span class="p">,</span><span class="n">samples</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The coefficients control the sensitivity of each variable. Specifically</span>
<span class="sd">    they limit the range of the outputs, i.e.</span>
<span class="sd">    1-1/(1+a_i) &lt;= (abs(4*x-2)+a_i)/(a_i+1) &lt;= 1-1/(1+a_i)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nvars</span><span class="p">,</span><span class="n">nsamples</span> <span class="o">=</span> <span class="n">samples</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">assert</span> <span class="n">coefficients</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">nvars</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">samples</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">coefficients</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span><span class="o">/</span>
                   <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">coefficients</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">nsamples</span>
    <span class="k">return</span> <span class="n">vals</span></div>

<div class="viewcode-block" id="get_sobol_g_function_statistics"><a class="viewcode-back" href="../../../api/pyapprox.benchmarks.sensitivity_benchmarks.get_sobol_g_function_statistics.html#pyapprox.benchmarks.sensitivity_benchmarks.get_sobol_g_function_statistics">[docs]</a><span class="k">def</span> <span class="nf">get_sobol_g_function_statistics</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">interaction_terms</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    See article: Variance based sensitivity analysis of model output. </span>
<span class="sd">    Design and estimator for the total sensitivity index</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nvars</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">unnormalized_main_effects</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">variance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">unnormalized_main_effects</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">main_effects</span> <span class="o">=</span> <span class="n">unnormalized_main_effects</span><span class="o">/</span><span class="n">variance</span>
    <span class="n">total_effects</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">unnormalized_main_effects</span><span class="o">+</span><span class="mi">1</span><span class="p">),(</span><span class="n">nvars</span><span class="p">))</span>
    <span class="n">total_effects</span> <span class="o">*=</span> <span class="n">unnormalized_main_effects</span><span class="o">/</span><span class="p">(</span><span class="n">unnormalized_main_effects</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">total_effects</span> <span class="o">/=</span> <span class="n">variance</span>
    <span class="k">if</span> <span class="n">interaction_terms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">mean</span><span class="p">,</span><span class="n">variance</span><span class="p">,</span><span class="n">main_effects</span><span class="p">,</span><span class="n">total_effects</span>
    
    <span class="n">sobol_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="n">unnormalized_main_effects</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span><span class="o">/</span><span class="n">variance</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">interaction_terms</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span><span class="n">variance</span><span class="p">,</span><span class="n">main_effects</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span><span class="n">total_effects</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span><span class="n">sobol_indices</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span></div>


<div class="viewcode-block" id="morris_function"><a class="viewcode-back" href="../../../api/pyapprox.benchmarks.sensitivity_benchmarks.morris_function.html#pyapprox.benchmarks.sensitivity_benchmarks.morris_function">[docs]</a><span class="k">def</span> <span class="nf">morris_function</span><span class="p">(</span><span class="n">samples</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">20</span>
    <span class="n">beta0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span>
    <span class="n">beta_first_order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">beta_first_order</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">=</span><span class="mi">20</span>
    <span class="n">beta_first_order</span><span class="p">[</span><span class="mi">10</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">beta_second_order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
    <span class="n">beta_second_order</span><span class="p">[:</span><span class="mi">6</span><span class="p">,:</span><span class="mi">6</span><span class="p">]</span><span class="o">=-</span><span class="mi">15</span>
    <span class="n">beta_second_order</span><span class="p">[</span><span class="mi">6</span><span class="p">:,</span><span class="mi">6</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,(</span><span class="mi">14</span><span class="p">,</span><span class="mi">14</span><span class="p">))</span>
    <span class="c1">#beta_third_order = np.zeros((20,20,20))</span>
    <span class="c1">#beta_third_order[:5,:5,:5]=-10</span>
    <span class="n">beta_third_order</span><span class="o">=-</span><span class="mi">10</span>
    <span class="c1">#beta_forth_order = np.zeros((20,20,20,20))</span>
    <span class="c1">#beta_forth_order[:4,:4,:4,:4]=5</span>
    <span class="n">beta_forth_order</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">ww</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">samples</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">I</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span>
    <span class="n">ww</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.1</span> <span class="o">*</span> <span class="n">samples</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">values</span> <span class="o">=</span> <span class="n">beta0</span>
    <span class="n">values</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">beta_first_order</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">*</span><span class="n">ww</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">jj</span><span class="p">):</span>
            <span class="n">values</span> <span class="o">+=</span> <span class="n">beta_second_order</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">]</span><span class="o">*</span><span class="n">ww</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="n">ww</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">kk</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">jj</span><span class="p">):</span>
                <span class="n">values</span> <span class="o">+=</span> <span class="n">beta_third_order</span><span class="o">*</span><span class="n">ww</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="n">ww</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">*</span><span class="n">ww</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">ll</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ll</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">kk</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">jj</span><span class="p">):</span>
                    <span class="n">values</span> <span class="o">+=</span> <span class="n">beta_forth_order</span><span class="o">*</span><span class="n">ww</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">*</span><span class="n">ww</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">*</span><span class="n">ww</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span><span class="o">*</span><span class="n">ww</span><span class="p">[</span><span class="n">ll</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">values</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019 National Technology &amp; Engineering Solutions of Sandia, LLC (NTESS). Under the terms of Contract DE-NA0003525 with NTESS, the U.S. Government retains certain rights in this software.

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>